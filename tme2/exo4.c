#include <stdio.h>
#include <stdlib.h>
#include <unistd.h> 
#include <sys/times.h>



void lance_commande(char *commande) {
    
    struct tms begin,end;  //  struct a propos de la fonction times()
    clock_t time_begin,time_end;
    long tck = 0;
    tck = sysconf(_SC_CLK_TCK);//Obtenir l'horloge du système (combien en 1 seconde)

    time_begin = times(&begin); 
    int ret = system(commande);
    time_end = times(&end);

    if (ret == -1) {
        printf("Erreur\n");
        return;
    }

    double total = (time_end-time_begin)/(double)tck;
    double user = (end.tms_utime-begin.tms_utime)/(double)tck;
    double system = (end.tms_stime-begin.tms_stime)/(double)tck;
    double user_children = (end.tms_cutime-begin.tms_cutime)/(double)tck;
    double system_children = (end.tms_cstime-begin.tms_cstime)/(double)tck;

    printf("Statistiques de '%s':\n", commande);
    printf("Temps total: %f\n", total);
    printf("Temps utilisateur: %f\n", user);
    printf("Temps système: %f\n", system);
    printf("Temps utilisateur fils: %f\n", user_children);
    printf("Temps système fils: %f\n", system_children);
}

int main(int argc, char *argv[]) {
    int i;
    for (i = 1; i < argc; i++) {
        lance_commande(argv[i]);
    }
    return 0;
}
